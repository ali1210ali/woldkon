<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeliÅŸmiÅŸ Metin DÃ¼zenleyici</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Genel stiller */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #ffcc00, #ff6600);
            animation: backgroundFade 5s infinite alternate;
            padding: 10px;
        }

        @keyframes backgroundFade {
            from { background: linear-gradient(135deg, #ffcc00, #ff6600); }
            to { background: linear-gradient(135deg, #ff6600, #ffcc00); }
        }

        h2 {
            animation: slideIn 3s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .toolbar {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        /* HavalÄ± buton stili */
        .toolbar-button {
            padding: 10px 20px;
            font-size: 14px;
            color: white;
            background: linear-gradient(45deg, #ff6600, #ffcc00);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin: 5px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .toolbar-button:hover {
            background: linear-gradient(45deg, #ffcc00, #ff6600);
        }

        #editor, #preview {
            width: 100%;
            max-width: 800px;
            height: 60vh;
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
            overflow-y: auto;
            animation: fadeIn 2s ease;
            box-sizing: border-box;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .toolbar select, .toolbar input[type="color"] {
            padding: 5px;
            font-size: 14px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        /* Gece modu stilleri */
        .dark-mode {
            background: linear-gradient(135deg, #1e1e1e, #121212);
            color: #ffffff;
        }
        .dark-mode #editor {
            background: #2d2d2d;
            color: #ffffff;
            border-color: #444;
        }

        /* Ä°statistikler paneli */
        #stats {
            margin-top: 10px;
            font-size: 14px;
        }

        /* Emoji seÃ§ici */
        #emojiPicker {
            display: none;
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            padding: 10px;
            z-index: 1000;
        }

        /* Bul ve deÄŸiÅŸtir paneli */
        #findReplace {
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <!-- GiriÅŸ SayfasÄ± -->
    <div id="login-page">
        <h2>GiriÅŸ Yap</h2>
        <input type="text" id="username" placeholder="KullanÄ±cÄ± AdÄ±" autofocus>
        <input type="password" id="password" placeholder="Åifre">
        <button class="toolbar-button" onclick="login()">GiriÅŸ Yap</button>
        <p id="error-message" style="color: red; display: none;">GeÃ§ersiz kullanÄ±cÄ± adÄ± veya ÅŸifre!</p>
    </div>

    <!-- Metin DÃ¼zenleyici SayfasÄ± -->
    <div id="editor-page" style="display: none;">
        <h2>GeliÅŸmiÅŸ Metin DÃ¼zenleyici</h2>
        <div class="toolbar">
            <button class="toolbar-button" onclick="formatText('bold')">KalÄ±n</button>
            <button class="toolbar-button" onclick="formatText('italic')">Ä°talik</button>
            <button class="toolbar-button" onclick="formatText('underline')">AltÄ± Ã‡izili</button>
            <button class="toolbar-button" onclick="alignText('justifyLeft')">Sola Hizala</button>
            <button class="toolbar-button" onclick="alignText('justifyCenter')">Ortala</button>
            <button class="toolbar-button" onclick="alignText('justifyRight')">SaÄŸa Hizala</button>
            <button class="toolbar-button" onclick="insertList('insertUnorderedList')">Madde Ä°ÅŸaretli Liste</button>
            <button class="toolbar-button" onclick="insertList('insertOrderedList')">SayÄ±lÄ± Liste</button>
            <button class="toolbar-button" onclick="insertTable()">Tablo Ekle</button>
            <button class="toolbar-button" onclick="insertImage()">Resim Ekle</button>
            <button class="toolbar-button" onclick="insertLink()">BaÄŸlantÄ± Ekle</button>
            <button class="toolbar-button" onclick="insertExcelTable()">Excel Tablosu Ekle</button>
            <button class="toolbar-button" onclick="insertWordArt()">WordArt Ekle</button>
            <button class="toolbar-button" onclick="buyutYazi()">YazÄ±yÄ± BÃ¼yÃ¼t</button>
            <button class="toolbar-button" onclick="yeniYaziTipi()">Yeni YazÄ± Tipi</button>
            <button class="toolbar-button" onclick="toggleDarkMode()">Gece Modu</button>
            <button class="toolbar-button" onclick="openEmojiPicker()">ğŸ˜Š Emoji Ekle</button>
            <button class="toolbar-button" onclick="openFindReplace()">Bul ve DeÄŸiÅŸtir</button>
            <button class="toolbar-button" onclick="downloadAsPDF()">PDF Olarak Ä°ndir</button>
            <input type="color" id="colorPicker" onchange="changeColor(this.value)">
            <input type="color" id="bgColorPicker" onchange="changeBgColor(this.value)">
            <select onchange="changeFont(this.value)">
                <option value="Arial">Arial</option>
                <option value="Courier New">Courier New</option>
                <option value="Georgia">Georgia</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Verdana">Verdana</option>
            </select>
            <select id="fontSizeSelect" onchange="changeFontSize(this.value)">
                <option value="1">8pt</option>
                <option value="2">10pt</option>
                <option value="3">12pt</option>
                <option value="4">14pt</option>
                <option value="5">18pt</option>
                <option value="6">24pt</option>
            </select>
            <button class="toolbar-button" onclick="saveText()">Metni Kaydet</button>
            <button class="toolbar-button" onclick="logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
        </div>
        <div id="editor" contenteditable="true" spellcheck="true">Buraya yazÄ±nÄ±z...</div>
        <div id="stats">
            Karakter: <span id="charCount">0</span> | 
            Kelime: <span id="wordCount">0</span> | 
            SatÄ±r: <span id="lineCount">0</span>
        </div>
        <div id="emojiPicker">
            <span onclick="insertEmoji('ğŸ˜Š')">ğŸ˜Š</span>
            <span onclick="insertEmoji('ğŸ˜‚')">ğŸ˜‚</span>
            <span onclick="insertEmoji('â¤ï¸')">â¤ï¸</span>
            <span onclick="insertEmoji('ğŸ”¥')">ğŸ”¥</span>
        </div>
        <div id="findReplace">
            <input type="text" id="findText" placeholder="Bul">
            <input type="text" id="replaceText" placeholder="DeÄŸiÅŸtir">
            <button onclick="findAndReplace()">Uygula</button>
        </div>
    </div>

    <audio id="backgroundAudio" autoplay loop></audio>

    <script>
        // KullanÄ±cÄ± kayÄ±tlarÄ± (basit bir Ã¶rnek iÃ§in localStorage kullanÄ±yoruz)
        let users = JSON.parse(localStorage.getItem('users')) || [];

        // GiriÅŸ yapma fonksiyonu
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('currentUser', username);
                showEditorPage();
            } else {
                document.getElementById('error-message').style.display = 'block';
            }
        }

        // Ã‡Ä±kÄ±ÅŸ yapma fonksiyonu
        function logout() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('currentUser');
            showLoginPage();
        }

        // GiriÅŸ sayfasÄ±nÄ± gÃ¶ster
        function showLoginPage() {
            document.getElementById('login-page').style.display = 'block';
            document.getElementById('editor-page').style.display = 'none';
        }

        // Metin dÃ¼zenleyici sayfasÄ±nÄ± gÃ¶ster
        function showEditorPage() {
            document.getElementById('login-page').style.display = 'none';
            document.getElementById('editor-page').style.display = 'block';
        }

        // Sayfa yÃ¼klendiÄŸinde kullanÄ±cÄ± giriÅŸ durumunu kontrol et
        window.onload = function () {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn === 'true') {
                showEditorPage();
            } else {
                showLoginPage();
            }

            // KaydedilmiÅŸ metni yÃ¼kle
            let savedText = localStorage.getItem("savedText");
            if (savedText) {
                document.getElementById("editor").innerHTML = savedText;
            }

            // MP3 dosyasÄ±nÄ± yÃ¼kleme
            document.getElementById('backgroundAudio').src = 'mex.mp3';

            // Ä°statistikleri gÃ¼ncelle
            updateStats();
        };

        // Metin biÃ§imlendirme fonksiyonlarÄ±
        function formatText(command) {
            document.execCommand(command, false, null);
        }

        function alignText(command) {
            document.execCommand(command, false, null);
        }

        function changeColor(color) {
            document.execCommand('foreColor', false, color);
        }

        function changeBgColor(color) {
            document.execCommand('hiliteColor', false, color);
        }

        function changeFont(font) {
            document.execCommand('fontName', false, font);
        }

        function changeFontSize(size) {
            document.execCommand('fontSize', false, size);
        }

        function insertList(command) {
            document.execCommand(command, false, null);
        }

        function insertTable() {
            let rows = prompt("SatÄ±r sayÄ±sÄ±nÄ± girin:", 2);
            let cols = prompt("SÃ¼tun sayÄ±sÄ±nÄ± girin:", 2);
            if (rows > 0 && cols > 0) {
                let table = "<table border='1'>";
                for (let i = 0; i < rows; i++) {
                    table += "<tr>";
                    for (let j = 0; j < cols; j++) {
                        table += "<td> </td>";
                    }
                    table += "</tr>";
                }
                table += "</table>";
                document.execCommand('insertHTML', false, table);
            }
        }

        function insertImage() {
            let url = prompt("Resim URL'sini girin:");
            if (url) {
                document.execCommand('insertImage', false, url);
            }
        }

        function insertLink() {
            let url = prompt("BaÄŸlantÄ± URL'sini girin:");
            if (url) {
                document.execCommand('createLink', false, url);
            }
        }

        function insertExcelTable() {
            let rows = prompt("SatÄ±r sayÄ±sÄ±nÄ± girin:", 5);
            let cols = prompt("SÃ¼tun sayÄ±sÄ±nÄ± girin:", 5);
            if (rows > 0 && cols > 0) {
                let table = "<table border='1' style='border-collapse: collapse;'>";
                for (let i = 0; i < rows; i++) {
                    table += "<tr>";
                    for (let j = 0; j < cols; j++) {
                        table += "<td style='padding: 5px; border: 1px solid #000;'> </td>";
                    }
                    table += "</tr>";
                }
                table += "</table>";
                document.execCommand('insertHTML', false, table);
            }
        }

        function insertWordArt() {
            let text = prompt("WordArt metnini girin:");
            if (text) {
                let wordArt = `<span style="font-family: 'Comic Sans MS', cursive, sans-serif; font-size: 2em; color: #ff6b6b; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);">${text}</span>`;
                document.execCommand('insertHTML', false, wordArt);
            }
        }

        function saveText() {
            let text = document.getElementById("editor").innerHTML;
            localStorage.setItem("savedText", text);
            alert("Metin kaydedildi!");
        }

        function buyutYazi() {
            const yaziElementi = document.getElementById('editor');
            const mevcutBoyut = window.getComputedStyle(yaziElementi, null).getPropertyValue('font-size');
            const yeniBoyut = parseFloat(mevcutBoyut) + 2;
            yaziElementi.style.fontSize = yeniBoyut + 'px';
        }

        function yeniYaziTipi() {
            const yaziElementi = document.getElementById('editor');
            yaziElementi.style.fontFamily = 'Arial, sans-serif';
        }

        function downloadText() {
            let text = document.getElementById("editor").innerHTML;
            let blob = new Blob([text], { type: "text/html" });
            let url = URL.createObjectURL(blob);
            let a = document.createElement("a");
            a.href = url;
            a.download = "metin.html";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Gece modu fonksiyonu
        function toggleDarkMode() {
            const body = document.body;
            body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', body.classList.contains('dark-mode'));
        }

        // Emoji ekleme fonksiyonu
        function openEmojiPicker() {
            const picker = document.getElementById('emojiPicker');
            picker.style.display = 'block';
        }

        function insertEmoji(emoji) {
            const editor = document.getElementById('editor');
            editor.innerHTML += emoji;
            document.getElementById('emojiPicker').style.display = 'none';
        }

        // Bul ve deÄŸiÅŸtir fonksiyonu
        function openFindReplace() {
            const findReplace = document.getElementById('findReplace');
            findReplace.style.display = 'block';
        }

        function findAndReplace() {
            const editor = document.getElementById('editor');
            const findText = document.getElementById('findText').value;
            const replaceText = document.getElementById('replaceText').value;
            const content = editor.innerHTML;
            const newContent = content.replace(new RegExp(findText, 'g'), replaceText);
            editor.innerHTML = newContent;
        }

        // Metin istatistiklerini gÃ¼ncelleme fonksiyonu
        function updateStats() {
            const editor = document.getElementById('editor');
            const text = editor.innerText;

            // Karakter sayÄ±sÄ±
            const charCount = text.length;
            document.getElementById('charCount').textContent = charCount;

            // Kelime sayÄ±sÄ±
            const wordCount = text.trim().split(/\s+/).filter(word => word.length > 0).length;
            document.getElementById('wordCount').textContent = wordCount;

            // SatÄ±r sayÄ±sÄ±
            const lineCount = text.split('\n').length;
            document.getElementById('lineCount').textContent = lineCount;
        }

        // Editor iÃ§eriÄŸi deÄŸiÅŸtiÄŸinde istatistikleri gÃ¼ncelle
        document.getElementById('editor').addEventListener('input', updateStats);

        // SÃ¼rÃ¼kle-bÄ±rak ile resim ekleme
        const editor = document.getElementById('editor');

        editor.addEventListener('dragover', (e) => {
            e.preventDefault();
        });

        editor.addEventListener('drop', (e) => {
            e.preventDefault();
            const file = e.dataTransfer.files[0];
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = document.createElement('img');
                    img.src = event.target.result;
                    editor.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        });

        // PDF indirme fonksiyonu
        function downloadAsPDF() {
            const { jsPDF } = window.jspdf; // jsPDF kÃ¼tÃ¼phanesini kullan

            // Editor iÃ§eriÄŸini al
            const editor = document.getElementById('editor');

            // HTML iÃ§eriÄŸini gÃ¶rÃ¼ntÃ¼ye dÃ¶nÃ¼ÅŸtÃ¼r
            html2canvas(editor).then((canvas) => {
                const imgData = canvas.toDataURL('image/png'); // GÃ¶rÃ¼ntÃ¼yÃ¼ base64 formatÄ±na dÃ¶nÃ¼ÅŸtÃ¼r
                const pdf = new jsPDF('p', 'mm', 'a4'); // Yeni bir PDF belgesi oluÅŸtur

                const imgWidth = 210; // A4 kaÄŸÄ±dÄ±nÄ±n geniÅŸliÄŸi (mm)
                const imgHeight = (canvas.height * imgWidth) / canvas.width; // GÃ¶rÃ¼ntÃ¼ yÃ¼ksekliÄŸini orantÄ±lÄ± olarak ayarla

                // GÃ¶rÃ¼ntÃ¼yÃ¼ PDF'e ekle
                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);

                // PDF'i indir
                pdf.save('metin.pdf');
            });
        }
    </script>
</body>
</html>